<h1>Pals</h1>

@if (result) {
  <div class="mb-4">
    <h5>Filters</h5>
    <div class="ps-2">
      <app-browse-pals-filters (filtersChange)="onFiltersChange($event); refresh()"></app-browse-pals-filters>
    </div>
  </div>

  <div class="mb-2">
    @if (result) {
      @if (result.results.length < result.pagination.totalCount) {
        {{ currentPageRange[0] }}..{{ currentPageRange[1] }} / {{ result.pagination.totalCount }} results
      } @else {
        {{ result.results.length }} results
      }
    }
  </div>

  <div class="list-group list-group-flush">
    @for (tribe of result.results; track tribe.name) {
      <a class="list-group-item list-group-item-action" [routerLink]="['..', tribe.name]">
        <app-pal-nav-list-item [tribe]="tribe"></app-pal-nav-list-item>
      </a>
    }
  </div>

  @if (result.pagination.totalPages > 1) {
    <nav class="mt-4">
      <ul class="pagination align-items-center justify-content-center">
        <li class="page-item" [class.disabled]="result.pagination.pageNumber <= 1">
          <a class="page-link user-select-none" (click)="previousPage()" role="button" aria-label="Previous"> <span aria-hidden="true">&laquo;</span> </a>
        </li>
        @if (result.pagination.totalPages <= 20) {
          @for (page of [].constructor(result.pagination.totalPages); track page) {
            <a
              class="page-link"
              [class.active]="$index + 1 == result.pagination.pageNumber"
              (click)="goToPage($index + 1)"
              role="button"
              [attr.aria-label]="'Page ' + ($index + 1)"
            >
              {{ $index + 1 }}
            </a>
          }
        } @else {
          <li class="page-link">
            {{ result.pagination.pageNumber }}
            /
            {{ result.pagination.totalPages }}
          </li>
        }
        <li class="page-item" [class.disabled]="result.pagination.pageNumber >= result.pagination.totalPages">
          <a class="page-link user-select-none" (click)="nextPage()" role="button" aria-label="Next"> <span aria-hidden="true">&raquo;</span> </a>
        </li>
      </ul>
    </nav>
  }
}
